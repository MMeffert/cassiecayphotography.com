---
phase: 20-offcanvas-navigation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - index.html
  - style/js/custom-scripts.js
  - style/style.css
autonomous: true

must_haves:
  truths:
    - "Mobile users can open navigation via hamburger icon"
    - "Offcanvas drawer slides in from left side on mobile"
    - "Close button and backdrop dismiss the menu"
    - "Navigation links close menu and scroll to section"
    - "Sticky header also uses offcanvas (shared instance)"
    - "Desktop navigation unchanged (horizontal navbar)"
  artifacts:
    - path: "index.html"
      provides: "Offcanvas HTML structure with proper ARIA attributes"
      contains: "offcanvas-start"
    - path: "style/js/custom-scripts.js"
      provides: "Offcanvas event handlers for link clicks and hamburger sync"
      contains: "bootstrap.Offcanvas"
    - path: "style/style.css"
      provides: "Offcanvas styling matching site theme"
      contains: "offcanvas"
  key_links:
    - from: "index.html"
      to: "Bootstrap 5.3.3 offcanvas"
      via: "data-bs-toggle='offcanvas' data-bs-target='#offcanvasNav'"
      pattern: "data-bs-toggle=\"offcanvas\""
    - from: "style/js/custom-scripts.js"
      to: "offcanvas element"
      via: "Bootstrap Offcanvas API"
      pattern: "bootstrap\\.Offcanvas"
---

<objective>
Replace Bootstrap 5 navbar collapse with offcanvas drawer for mobile navigation

Purpose: Provide modern mobile UX with slide-in drawer that's more intuitive than push-down collapse
Output: Mobile navigation that slides from left, closes on link click, works with existing sticky header
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/20-offcanvas-navigation/20-RESEARCH.md
@.planning/phases/12-navigation-sticky-header/12-01-SUMMARY.md

# Source files to modify
@index.html
@style/js/custom-scripts.js
@style/style.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Convert navbar collapse to offcanvas structure</name>
  <files>index.html</files>
  <action>
Modify the navbar HTML structure to use Bootstrap 5 offcanvas instead of collapse.

Find the existing navbar structure (around line 228-250):
```html
<nav class="navbar transparent absolute nav-wrapper-dark inverse-text navbar-expand-lg text-uppercase">
  ...
  <div class="navbar-hamburger ms-auto d-lg-none d-xl-none">
    <button class="hamburger animate" data-bs-toggle="collapse" data-bs-target=".navbar-collapse">
      <span></span>
    </button>
  </div>
  ...
  <div class="collapse navbar-collapse">
    <ul class="nav navbar-nav ms-auto">
      ...
    </ul>
  </div>
```

Replace with offcanvas structure:
```html
<nav class="navbar transparent absolute nav-wrapper-dark inverse-text navbar-expand-lg text-uppercase">
  <div class="container">
    <div class="navbar-header">
      <div class="navbar-brand">...</div>
      <div class="navbar-hamburger ms-auto d-lg-none d-xl-none">
        <button class="hamburger animate" type="button"
                data-bs-toggle="offcanvas"
                data-bs-target="#offcanvasNav"
                aria-controls="offcanvasNav"
                aria-label="Toggle navigation">
          <span></span>
        </button>
      </div>
    </div>
    <!-- Offcanvas container -->
    <div class="offcanvas offcanvas-start" tabindex="-1"
         id="offcanvasNav"
         aria-labelledby="offcanvasNavLabel">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="offcanvasNavLabel">Menu</h5>
        <button type="button" class="btn-close btn-close-white"
                data-bs-dismiss="offcanvas"
                aria-label="Close"></button>
      </div>
      <div class="offcanvas-body">
        <ul class="nav navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link scroll" href="#home">Home</a></li>
          <li class="nav-item"><a class="nav-link scroll" href="#about">About</a></li>
          <li class="nav-item"><a class="nav-link scroll" href="#portfolio">Portfolio</a></li>
          <li class="nav-item"><a class="nav-link scroll" href="#services">Services</a></li>
          <li class="nav-item"><a class="nav-link scroll" href="#contact">Schedule</a></li>
          <li class="nav-item"><a class="nav-link scroll" href="#contact">Contact</a></li>
        </ul>
      </div>
    </div>
  </div>
</nav>
```

Key changes:
1. Hamburger button: `data-bs-toggle="collapse"` -> `data-bs-toggle="offcanvas"`
2. Hamburger button: `data-bs-target=".navbar-collapse"` -> `data-bs-target="#offcanvasNav"`
3. Add `aria-controls="offcanvasNav"` and `aria-label="Toggle navigation"` to hamburger
4. Replace `<div class="collapse navbar-collapse">` with offcanvas structure
5. Add `tabindex="-1"` to offcanvas container
6. Use `btn-close-white` since the menu is dark
7. Offcanvas placement is `offcanvas-start` (slides from left)

IMPORTANT: Keep the `.navbar-expand-lg` class on the nav element - this makes offcanvas behavior mobile-only, horizontal navbar on desktop.
  </action>
  <verify>
Run local build and inspect HTML:
```bash
cd /Users/mitchellmeffert/Git/Personal/cassiecayphotography.com
npm run build
```
Then validate HTML structure includes offcanvas elements with correct ARIA attributes.
  </verify>
  <done>
index.html contains offcanvas structure with:
- `data-bs-toggle="offcanvas"` on hamburger button
- `id="offcanvasNav"` on offcanvas container
- `offcanvas-start` class for left-side slide
- Offcanvas header with close button
- Proper ARIA attributes (aria-labelledby, aria-controls, tabindex)
  </done>
</task>

<task type="auto">
  <name>Task 2: Update JavaScript for offcanvas behavior</name>
  <files>style/js/custom-scripts.js</files>
  <action>
Update the sticky header and hamburger menu JavaScript to work with offcanvas.

1. **Remove existing hamburger click toggle** (lines ~117-136 in custom-scripts.js):
   The existing hamburger click handler toggles `.active` class on click. This needs to be replaced with offcanvas event listeners that sync the hamburger state.

2. **Update sticky header clone** (around line 53-74):
   The sticky header clones the navbar. Instead of initializing Bootstrap Collapse on the clone, update to reference the shared offcanvas element. Since offcanvas is by ID (`#offcanvasNav`), both original and cloned hamburger buttons can trigger the same offcanvas.

   Remove the Bootstrap Collapse initialization on clone:
   ```javascript
   // Remove this block:
   var cloneCollapse = clone.querySelector('.navbar-collapse');
   if (cloneCollapse) {
       new bootstrap.Collapse(cloneCollapse, { toggle: false });
   }
   ```

3. **Add offcanvas event listeners for hamburger sync**:
   Replace the hamburger click handler with offcanvas event-driven state sync:
   ```javascript
   /*-----------------------------------------------------------------------------------*/
   /*	OFFCANVAS NAVIGATION (Vanilla JS - syncs hamburger state)
   /*-----------------------------------------------------------------------------------*/
   (function() {
       var offcanvasElement = document.getElementById('offcanvasNav');
       if (!offcanvasElement) return;

       var hamburgerButtons = document.querySelectorAll('.hamburger.animate');

       // Sync hamburger active state with offcanvas visibility
       offcanvasElement.addEventListener('show.bs.offcanvas', function() {
           hamburgerButtons.forEach(function(btn) {
               btn.classList.add('active');
           });
       });

       offcanvasElement.addEventListener('hidden.bs.offcanvas', function() {
           hamburgerButtons.forEach(function(btn) {
               btn.classList.remove('active');
           });
       });

       // Close offcanvas on navigation link click (smooth scroll without jerky behavior)
       // DON'T use data-bs-dismiss on links - causes jerky scroll
       document.querySelectorAll('#offcanvasNav .nav-link').forEach(function(link) {
           link.addEventListener('click', function() {
               var offcanvas = bootstrap.Offcanvas.getInstance(offcanvasElement);
               if (offcanvas) {
                   offcanvas.hide();
               }
           });
       });
   })();
   ```

4. **Update the sticky header cloning logic**:
   After cloning the navbar, ensure the cloned hamburger button also targets `#offcanvasNav`. Since data attributes are cloned, this should work automatically. But verify the clone doesn't duplicate the offcanvas element (it should reference the same one).

   After the clone is created (line ~64-67), add:
   ```javascript
   // Remove any offcanvas element from clone (use single shared instance)
   var cloneOffcanvas = clone.querySelector('.offcanvas');
   if (cloneOffcanvas) {
       cloneOffcanvas.remove();
   }
   ```

5. **Remove the old "Close mobile nav on link click" handler** that uses Bootstrap Collapse API (around lines 126-136).

IMPORTANT: Use the Bootstrap Offcanvas JavaScript API (`bootstrap.Offcanvas.getInstance()` and `.hide()`) - NOT data-bs-dismiss on links, which causes jerky scroll behavior per research.
  </action>
  <verify>
Build and manually test:
```bash
cd /Users/mitchellmeffert/Git/Personal/cassiecayphotography.com
npm run build
npm run preview
```
1. On mobile viewport (<992px), click hamburger - offcanvas should slide from left
2. Click any nav link - should close offcanvas and scroll to section smoothly
3. Click outside offcanvas (backdrop) - should close
4. Press Escape - should close
5. Hamburger icon should animate (X shape) when open, revert when closed
6. Scroll down until sticky header appears, click its hamburger - same offcanvas should open
  </verify>
  <done>
custom-scripts.js:
- Offcanvas event listeners sync hamburger `.active` state on show/hidden
- Nav link clicks use `bootstrap.Offcanvas.getInstance().hide()` for smooth close
- Sticky header clone removes duplicate offcanvas element
- Old Collapse-based hamburger handlers removed
  </done>
</task>

<task type="auto">
  <name>Task 3: Add offcanvas CSS styling</name>
  <files>style/style.css</files>
  <action>
Add CSS to style the offcanvas component matching the site's dark theme.

Add the following CSS after the HAMBURGER MENU ICON section (around line 986):

```css
/*-----------------------------------------------------------------------------------*/
/*	07. OFFCANVAS NAVIGATION
/*-----------------------------------------------------------------------------------*/
/* Offcanvas styling for mobile navigation */
.offcanvas {
    max-width: 280px;
}
.offcanvas-start {
    background: #151515;
}
.offcanvas-header {
    padding: 20px 25px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}
.offcanvas-title {
    color: #fff;
    font-family: 'Montserrat', sans-serif;
    font-weight: 600;
    font-size: 14px;
    letter-spacing: 2px;
    text-transform: uppercase;
}
.offcanvas-body {
    padding: 0;
}
.offcanvas-body .navbar-nav {
    padding: 15px 0;
}
.offcanvas-body .nav-item {
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}
.offcanvas-body .nav-link {
    color: rgba(255, 255, 255, 0.85) !important;
    padding: 15px 25px !important;
    font-size: 13px;
    letter-spacing: 2px;
    transition: background 0.2s ease, color 0.2s ease;
}
.offcanvas-body .nav-link:hover,
.offcanvas-body .nav-link:focus {
    color: #fff !important;
    background: rgba(255, 255, 255, 0.05);
}
/* Ensure offcanvas appears above sticky header */
/* Bootstrap z-index scale: sticky 1020, fixed 1030, offcanvas-backdrop 1040, offcanvas 1045 */
/* Our .banner--clone uses z-index 1039, which is below offcanvas backdrop (1040) - good */

/* On desktop (lg+), offcanvas should behave as inline navbar */
@media (min-width: 992px) {
    .offcanvas {
        position: static !important;
        background: transparent !important;
        border: none !important;
        transform: none !important;
        visibility: visible !important;
        max-width: none;
    }
    .offcanvas-header {
        display: none;
    }
    .offcanvas-body {
        padding: 0;
        overflow: visible;
    }
    .offcanvas-body .navbar-nav {
        flex-direction: row;
        padding: 0;
    }
    .offcanvas-body .nav-item {
        border-bottom: none;
    }
    .offcanvas-body .nav-link {
        padding: 20px 12px !important;
        color: inherit !important;
    }
    .offcanvas-body .nav-link:hover,
    .offcanvas-body .nav-link:focus {
        background: transparent;
    }
}
```

Also update the existing mobile navbar-collapse CSS (around line 5769) since `.navbar-collapse` no longer exists:
- The existing `.navbar .navbar-collapse { background: #151515; }` rule is now unused
- Keep it for backwards compatibility or remove it - it won't affect the new offcanvas

IMPORTANT: Do NOT change the z-index of `.banner--clone` (currently 1039). Bootstrap's offcanvas uses z-index 1045 with backdrop at 1040, which properly layers above the sticky header.
  </action>
  <verify>
Build and test responsive behavior:
```bash
cd /Users/mitchellmeffert/Git/Personal/cassiecayphotography.com
npm run build
npm run preview
```
1. Mobile (<992px): Offcanvas opens with dark background, menu items styled correctly
2. Desktop (>=992px): Navigation displays horizontally, no offcanvas behavior
3. Sticky header: Offcanvas opens above sticky header (proper z-index layering)
4. Offcanvas close button (X) is visible (white on dark background)
  </verify>
  <done>
style.css contains offcanvas CSS:
- `.offcanvas-start` with dark background (#151515)
- `.offcanvas-header` with border and title styling
- `.offcanvas-body` with navigation link hover states
- Desktop media query that converts offcanvas to inline navbar
- Z-index layering compatible with sticky header
  </done>
</task>

</tasks>

<verification>
After all tasks complete:

1. **Mobile viewport (<992px):**
   - [ ] Hamburger icon visible
   - [ ] Tapping hamburger opens offcanvas from left
   - [ ] Offcanvas has dark background with styled menu items
   - [ ] Close button (X) dismisses offcanvas
   - [ ] Clicking backdrop dismisses offcanvas
   - [ ] Pressing Escape dismisses offcanvas
   - [ ] Navigation links scroll to section AND close offcanvas
   - [ ] Hamburger animates to X when open, reverts when closed

2. **Sticky header:**
   - [ ] Scrolling down shows sticky header
   - [ ] Sticky header hamburger opens same offcanvas
   - [ ] Offcanvas appears above sticky header (z-index correct)

3. **Desktop viewport (>=992px):**
   - [ ] No hamburger icon visible
   - [ ] Navigation displays horizontally
   - [ ] No offcanvas behavior
   - [ ] All links work correctly

4. **Build verification:**
   ```bash
   cd /Users/mitchellmeffert/Git/Personal/cassiecayphotography.com
   npm run build
   npm run preview
   ```
   - [ ] No JavaScript errors in console
   - [ ] No build errors
</verification>

<success_criteria>
- NAV-01: Navbar collapse replaced with offcanvas (slides from left)
- NAV-02: Hamburger icon opens offcanvas on mobile
- NAV-03: Close button and backdrop dismiss menu
- NAV-04: Navigation links close menu after click (smooth, no jerky scroll)
- NAV-05: Sticky header uses same offcanvas instance
- NAV-06: Smooth animation transitions (Bootstrap default 300ms)
- Desktop navigation unchanged
- No JavaScript errors
- All 10 success criteria from ROADMAP.md satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/20-offcanvas-navigation/20-01-SUMMARY.md`
</output>
