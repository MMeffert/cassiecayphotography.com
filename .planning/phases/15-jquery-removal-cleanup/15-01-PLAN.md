---
phase: 15-jquery-removal-cleanup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - style/js/custom-scripts.js
autonomous: true

must_haves:
  truths:
    - "All JavaScript functionality works without jQuery loaded"
    - "Swiper quote slider initializes and navigates correctly"
    - "Background images load from data attributes"
    - "Mobile class applied on touch devices"
    - "One-page section offsets calculated correctly"
  artifacts:
    - path: "style/js/custom-scripts.js"
      provides: "jQuery-free custom scripts"
      contains: "document.addEventListener('DOMContentLoaded'"
  key_links:
    - from: "style/js/custom-scripts.js"
      to: "DOM elements"
      via: "querySelectorAll instead of $()"
      pattern: "document\\.querySelectorAll"
---

<objective>
Convert all remaining jQuery patterns in custom-scripts.js to vanilla JavaScript.

Purpose: Eliminate jQuery dependency from the only file still using it, enabling jQuery removal in Plan 02.
Output: jQuery-free custom-scripts.js that maintains all existing functionality.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/15-jquery-removal-cleanup/15-RESEARCH.md
@style/js/custom-scripts.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Convert jQuery patterns to vanilla JS</name>
  <files>style/js/custom-scripts.js</files>
  <action>
Convert all 7 jQuery patterns in custom-scripts.js to vanilla JavaScript:

1. **Line 7** - DOM ready wrapper:
   - Change: `$(document).ready(function() {`
   - To: `document.addEventListener('DOMContentLoaded', function() {`

2. **Lines 139-158** - Swiper initialization with `.each()`:
   - Change: `$(".basic-slider").each(function(index, element) {`
   - To: `document.querySelectorAll('.basic-slider').forEach(function(element, index) {`
   - Inside loop, change `var $this = $(this);` to use `element` directly
   - Change `$this.find(".swiper-container")` to `element.querySelector('.swiper-container')`
   - Change `.addClass()` to `.classList.add()`

3. **Line 163** - Overlay prepend:
   - Change: `$('.overlay > a, .overlay > span').prepend('<span class="bg"></span>');`
   - To:
     ```javascript
     document.querySelectorAll('.overlay > a, .overlay > span').forEach(function(el) {
         el.insertAdjacentHTML('afterbegin', '<span class="bg"></span>');
     });
     ```

4. **Lines 283-285** - Background image setter:
   - Change: `$(".bg-image").css('background-image', function() { ... });`
   - To:
     ```javascript
     document.querySelectorAll('.bg-image').forEach(function(el) {
         var bg = 'url(' + el.dataset.imageSrc + ')';
         el.style.backgroundImage = bg;
     });
     ```
   - Note: `$(this).data("image-src")` becomes `el.dataset.imageSrc` (camelCase)

5. **Line 291** - Mobile class addition:
   - Change: `$('.image-wrapper').addClass('mobile');`
   - To:
     ```javascript
     document.querySelectorAll('.image-wrapper').forEach(function(el) {
         el.classList.add('mobile');
     });
     ```

6. **Line 296** - Navbar height measurement:
   - Change: `var header_height = $('.navbar:not(.banner--clone)').outerHeight();`
   - To:
     ```javascript
     var navbarEl = document.querySelector('.navbar:not(.banner--clone)');
     var header_height = navbarEl ? navbarEl.offsetHeight : 0;
     ```
   - Note: jQuery's `outerHeight()` = vanilla `offsetHeight` (both include padding and border)

7. **Lines 302, 307** - Section style setters:
   - Change line 302: `$('.onepage section').css(firstStyle);`
   - To:
     ```javascript
     document.querySelectorAll('.onepage section').forEach(function(el) {
         el.style.paddingTop = shrinked_header_height + 'px';
         el.style.marginTop = '-' + shrinked_header_height + 'px';
     });
     ```
   - Change line 307: `$('.onepage section:first-of-type').css(secondStyle);`
   - To:
     ```javascript
     var firstSection = document.querySelector('.onepage section:first-of-type');
     if (firstSection) {
         firstSection.style.paddingTop = header_height + 'px';
         firstSection.style.marginTop = '-' + header_height + 'px';
     }
     ```

Update the file header comment to note the jQuery removal.
  </action>
  <verify>
Run grep to confirm no jQuery patterns remain:
```bash
grep -n '\$(' style/js/custom-scripts.js
grep -n 'jQuery' style/js/custom-scripts.js
```
Both commands should return no matches.
  </verify>
  <done>
All 7 jQuery patterns converted to vanilla JS. Zero `$(` or `jQuery` references in custom-scripts.js.
  </done>
</task>

<task type="auto">
  <name>Task 2: Build and functional verification</name>
  <files>dist/style/js/custom-scripts.js</files>
  <action>
1. Run the Vite build to update dist:
   ```bash
   npm run build
   ```

2. Start the dev server and verify functionality:
   ```bash
   npm run dev
   ```

3. Test each converted functional area in the browser:
   - Hero slider auto-advances (Embla - not affected, already vanilla)
   - Quote slider works (Swiper - converted in Task 1)
   - Overlay hover effects show background spans
   - Background images load on `.bg-image` elements
   - Mobile detection works (check DevTools mobile emulation)
   - One-page section offsets are correct

4. Check browser console for any JavaScript errors.

Note: The build will still include jQuery in output because we haven't removed it from index.html yet - that happens in Plan 02. This task verifies the converted code works correctly.
  </action>
  <verify>
```bash
npm run build 2>&1 | tail -20
```
Build completes without errors.

Browser console shows no JavaScript errors when testing the page.
  </verify>
  <done>
Build passes. All functionality works correctly with converted vanilla JS code. Ready for jQuery removal in Plan 02.
  </done>
</task>

</tasks>

<verification>
1. `grep -c '\$(' style/js/custom-scripts.js` returns 0
2. `npm run build` completes without errors
3. All interactive features function correctly in browser
</verification>

<success_criteria>
- JQ-04 (partial): No jQuery references remain in custom-scripts.js
- All 7 jQuery patterns converted to vanilla JavaScript
- Swiper quote slider initializes and works
- Background images load correctly
- Mobile class detection works
- One-page section offsets calculated correctly
- Build passes without errors
</success_criteria>

<output>
After completion, create `.planning/phases/15-jquery-removal-cleanup/15-01-SUMMARY.md`
</output>
