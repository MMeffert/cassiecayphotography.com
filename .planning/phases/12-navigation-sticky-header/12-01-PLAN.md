---
phase: 12-navigation-sticky-header
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - style/js/custom-scripts.js
  - style/style.css
autonomous: true

must_haves:
  truths:
    - "Sticky header appears after scrolling past hero section (~350px)"
    - "Header hides when scrolling down, shows when scrolling up"
    - "Mobile hamburger menu opens/closes with animation on both original and sticky navbar"
    - "All navigation links scroll smoothly to their targets"
    - "Smooth scroll respects prefers-reduced-motion setting"
  artifacts:
    - path: "style/js/custom-scripts.js"
      provides: "Vanilla JS sticky header using IntersectionObserver + scroll direction detection"
      contains: "IntersectionObserver"
    - path: "style/style.css"
      provides: "Smooth scroll CSS and banner--hidden class for show/hide behavior"
      contains: "scroll-behavior: smooth"
  key_links:
    - from: "style/js/custom-scripts.js"
      to: ".navbar"
      via: "IntersectionObserver watches sentinel, toggles banner--stick class"
      pattern: "banner--stick"
    - from: "style/style.css"
      to: "section[id]"
      via: "scroll-margin-top prevents sticky header from covering anchor targets"
      pattern: "scroll-margin-top"
---

<objective>
Implement vanilla JS sticky header and CSS smooth scroll to replace Headhesive and jQuery dependencies

Purpose: NAV-02 (Replace Headhesive with IntersectionObserver), NAV-03 (Maintain show/hide on scroll), NAV-04 (Mobile hamburger), CSS smooth scroll for anchor links
Output: Working sticky header with show/hide behavior, smooth scrolling for all anchor links, hamburger menu working on both navbars
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-navigation-sticky-header/12-RESEARCH.md

# Source files
@style/js/custom-scripts.js
@style/style.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add CSS for smooth scroll and header hide animation</name>
  <files>style/style.css</files>
  <action>
Add CSS rules to style/style.css in the NAVBAR section (near line 887 after .banner--stick):

1. Add `.banner--hidden` class for hide-on-scroll-down behavior:
```css
.banner--clone.banner--hidden {
    transform: translateY(-100%);
}
```

2. Add accessibility-aware smooth scrolling at end of file or in appropriate section:
```css
/* Smooth scrolling with accessibility respect */
@media (prefers-reduced-motion: no-preference) {
    html {
        scroll-behavior: smooth;
    }
}

/* Offset for fixed header on anchor targets */
section[id] {
    scroll-margin-top: 68px;
}
```

Why: CSS scroll-behavior replaces jQuery animate() + easing plugin. prefers-reduced-motion respects accessibility preferences. scroll-margin-top prevents sticky header from covering section headings when clicking nav links.
  </action>
  <verify>
`npm run build` succeeds. Check dist/style/style.css contains `scroll-behavior: smooth` and `banner--hidden`.
  </verify>
  <done>CSS file includes smooth scroll with accessibility media query, scroll-margin-top for sections, and banner--hidden class</done>
</task>

<task type="auto">
  <name>Task 2: Replace Headhesive and jQuery nav code with vanilla JS</name>
  <files>style/js/custom-scripts.js</files>
  <action>
Replace the STICKY HEADER section (lines 50-69) and HAMBURGER MENU ICON section (lines 71-79) and ONEPAGE SMOOTH SCROLL section (lines 290-315) in custom-scripts.js:

1. **Replace STICKY HEADER section** (remove Headhesive initialization):
```javascript
/*-----------------------------------------------------------------------------------*/
/*	STICKY HEADER (Vanilla JS - replaces Headhesive)
/*-----------------------------------------------------------------------------------*/
(function() {
    var navbar = document.querySelector('.navbar');
    if (!navbar) return;

    // Create sentinel at activation point (350px from top)
    var sentinel = document.createElement('div');
    sentinel.id = 'sticky-sentinel';
    sentinel.style.cssText = 'position:absolute;top:350px;height:1px;width:100%;pointer-events:none;';
    document.body.insertBefore(sentinel, document.body.firstChild);

    // Clone navbar for sticky version
    var clone = navbar.cloneNode(true);
    clone.classList.add('banner--clone', 'fixed');
    clone.classList.remove('absolute');
    document.body.insertBefore(clone, document.body.firstChild);

    // Initialize Bootstrap Collapse on cloned navbar (required for hamburger menu)
    var cloneCollapse = clone.querySelector('.navbar-collapse');
    if (cloneCollapse) {
        new bootstrap.Collapse(cloneCollapse, { toggle: false });
    }

    // Observe sentinel for sticky activation
    var stickyObserver = new IntersectionObserver(function(entries) {
        var entry = entries[0];
        if (!entry.isIntersecting) {
            clone.classList.add('banner--stick');
            clone.classList.remove('banner--unstick');
        } else {
            clone.classList.remove('banner--stick');
            clone.classList.add('banner--unstick');
        }
    }, { threshold: 0 });

    stickyObserver.observe(sentinel);

    // Scroll direction detection for show/hide (NAV-03)
    var lastScrollY = 0;
    var ticking = false;

    function onScroll() {
        var currentScrollY = window.pageYOffset;

        if (clone.classList.contains('banner--stick')) {
            if (currentScrollY > lastScrollY && currentScrollY > 400) {
                clone.classList.add('banner--hidden');
            } else {
                clone.classList.remove('banner--hidden');
            }
        }

        lastScrollY = currentScrollY;
        ticking = false;
    }

    window.addEventListener('scroll', function() {
        if (!ticking) {
            requestAnimationFrame(onScroll);
            ticking = true;
        }
    }, { passive: true });
})();
```

2. **Replace HAMBURGER MENU ICON section** with event delegation (works on both navbars):
```javascript
/*-----------------------------------------------------------------------------------*/
/*	HAMBURGER MENU ICON (Vanilla JS - works on original and cloned navbar)
/*-----------------------------------------------------------------------------------*/
document.addEventListener('click', function(e) {
    // Toggle hamburger animation on both navbars
    if (e.target.closest('.hamburger.animate')) {
        document.querySelectorAll('.hamburger.animate').forEach(function(btn) {
            btn.classList.toggle('active');
        });
    }

    // Close mobile nav on link click (one-page sites)
    if (e.target.closest('.onepage .navbar .nav li a')) {
        document.querySelectorAll('.navbar .navbar-collapse.show').forEach(function(openNav) {
            var collapse = bootstrap.Collapse.getInstance(openNav);
            if (collapse) collapse.hide();
        });
        document.querySelectorAll('.hamburger.animate').forEach(function(btn) {
            btn.classList.remove('active');
        });
    }
});
```

3. **Remove ONEPAGE SMOOTH SCROLL section entirely** (lines 290-315). CSS scroll-behavior handles this now. Keep only the empty anchor prevention:
```javascript
/*-----------------------------------------------------------------------------------*/
/*	ONEPAGE NAV LINKS
/*-----------------------------------------------------------------------------------*/
var empty_a = document.querySelectorAll('.onepage .navbar ul.navbar-nav a[href="#"]');
empty_a.forEach(function(a) {
    a.addEventListener('click', function(e) {
        e.preventDefault();
    });
});
```

Important implementation notes:
- Remove the `$($.SmartMenus.Bootstrap.init)` call - SmartMenus is removed in Plan 02
- Remove jQuery dependency from hamburger code - use vanilla JS event delegation
- Remove jQuery `$('html,body').animate()` - CSS handles smooth scroll
- Remove jQuery easing dependency - no longer needed
- Keep the code INSIDE the $(document).ready() wrapper since other code still uses jQuery
  </action>
  <verify>
Run `npm run build`. Test in browser:
1. Scroll past 350px - sticky header appears with slide-down animation
2. Scroll down fast - sticky header hides (slides up)
3. Scroll up - sticky header shows again
4. Click nav link - page scrolls smoothly to section
5. On mobile viewport: hamburger opens/closes on both original and sticky navbar
  </verify>
  <done>Sticky header activates via IntersectionObserver, hides/shows on scroll direction, hamburger works on both navbars, nav links scroll smoothly via CSS</done>
</task>

</tasks>

<verification>
1. `npm run build` completes without errors
2. Open `dist/index.html` in browser
3. Scroll test: header appears after ~350px, hides on scroll down, shows on scroll up
4. Click each nav link - smooth scroll to section, section heading visible (not under header)
5. Mobile test: hamburger toggles on both navbars
6. Accessibility: In dev tools, emulate `prefers-reduced-motion: reduce` - scrolling should be instant, not smooth
</verification>

<success_criteria>
- NAV-02: Headhesive replaced with vanilla JS (IntersectionObserver pattern)
- NAV-03: Show/hide on scroll direction works correctly
- NAV-04: Mobile hamburger works on both original and sticky navbar
- Smooth scroll: CSS scroll-behavior with prefers-reduced-motion respect
- No jQuery used in sticky header or hamburger code
</success_criteria>

<output>
After completion, create `.planning/phases/12-navigation-sticky-header/12-01-SUMMARY.md`
</output>
